import{c as E}from"./Checkbox-DE8TW4ph.js";import{o as m,c as k,a$ as x,aI as p,au as $,bn as v,t as _,u as g,r as B,bs as U,a as b,al as V}from"./index-ykP3-BHX.js";const S={class:"form-item__title"},w={__name:"TextareaLabel",props:{title:{default:"",type:String}},setup(u){const s=u;return(a,t)=>(m(),k("div",S,x(s.title),1))}},R={class:"textarea"},A=["disabled","value","placeholder","id"],N={class:"textarea__mirror"},z={__name:"TextareaField",props:{item:{default:{id:0,key:"",value:"",type:"text",placeholder:"",title:"Undefined title"},type:Object},disabled:{default:!1,type:Boolean},mask:{default:null,type:String},isUseEnter:{default:!0,type:Boolean}},emits:["changeValue"],setup(u,{emit:s}){let a=p(""),t=p(null);const i=s,e=u,h=l=>{const o=n=>{let r="^";n=n.replace(/[\s()\-+]/g,"");for(let d of n)switch(d){case"#":r+="[0-9]{1}";break;case"A":r+="[а-яa-zА-ЯA-Z]{1}";break;default:Number(d)!=NaN&&(r+="[\\d]{1}");break}return r+="$",new RegExp(r)},c=()=>/\n/i.test(l),y=()=>{let n=null,r=null;return l.length>e.mask.length?!1:(n=e.mask.replaceAll(" ","").substring(0,l.length),r=o(n),!!r.test(l))};(()=>{if(!e.isUseEnter&&c()){t.value.value=a.value;return}if(e.mask!=""&&![void 0,null].includes(e.mask))if(y())a.value=l;else{t.value.value=a.value;return}else a.value=l;i("changeValue",{key:e.item.key,value:l})})(),f()};$(()=>{e.isUseEnter?a.value=e.item.value:a.value=e.item.value!=null?String(e.item.value).replaceAll(`
`,""):e.item.value,new ResizeObserver(f).observe(t.value),e.item.focus&&t.value.focus()});const f=()=>{if(t.value!=null){let l=t.value.closest(".textarea").querySelector(".textarea__mirror");l.style.height="1px",l.style.height=6+t.value.scrollHeight+"px"}};return v(()=>e.item.value,()=>{e.isUseEnter?a.value=e.item.value:a.value=e.item.value!=null?String(e.item.value).replaceAll(`
`,""):e.item.value}),v(()=>e.item.focus,()=>{e.item.focus&&t.value.focus()}),(l,o)=>(m(),k("div",R,[_("textarea",{type:"text",ref_key:"textareaRef",ref:t,autocomplete:"off",disabled:e.disabled,value:g(a),placeholder:e.item.placeholder,id:`input_${e.item.id}`,onInput:o[0]||(o[0]=c=>h(c.target.value))}," ",40,A),_("pre",N,x(g(a)),1)]))}},q={__name:"Textarea",props:{item:{default:{id:0,key:"",title:"",value:"",type:"text",focus:!1,substring:"",placeholder:""},type:Object},disabled:{default:!1,type:Boolean},mask:{default:null,type:String},isUseEnter:{default:!0,type:Boolean}},setup(u){const s=u;return(a,t)=>(m(),B(E,{class:V(["form-item__textarea",s.item.required?"form-item_required":""])},{default:U(()=>[b(w,{title:s.item.title},null,8,["title"]),b(z,{item:s.item,mask:s.mask,disabled:s.disabled,isUseEnter:s.isUseEnter,onFocus:t[0]||(t[0]=i=>a.$emit("focus",i)),onBlur:t[1]||(t[1]=i=>a.$emit("blur",i)),onChangeValue:t[2]||(t[2]=i=>a.$emit("changeValue",i))},null,8,["item","mask","disabled","isUseEnter"])]),_:1},8,["class"]))}};export{q as default};
